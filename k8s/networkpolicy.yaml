apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: iptv-policy
  namespace: iptv
spec:
  podSelector: {}
  policyTypes:
    - Ingress
  ingress:
    # Allow from cloudflared ingress
    - from:
        - namespaceSelector:
            matchLabels:
              kubernetes.io/metadata.name: ingress
    # Allow from monitoring (Prometheus scraping)
    - from:
        - namespaceSelector:
            matchLabels:
              kubernetes.io/metadata.name: monitoring
    # Allow intra-namespace traffic
    - from:
        - podSelector: {}
